{% extends "base.html" %}

{% block title %}Schedule Virtual Meeting - Antlers{% endblock %}

{% block extra_css %}
<style>
    .meeting-header {
        background: linear-gradient(135deg, var(--primary-color-light) 0%, var(--primary-color) 100%);
        padding: 1.5rem 0;
        margin-bottom: 1.5rem;
        border-radius: 0 0 2rem 2rem;
        position: relative;
    }
    
    .dark-theme .meeting-header {
        background: linear-gradient(135deg, #3a1f5d 0%, #1a0a2e 100%);
    }
    
    .meeting-container {
        background: white;
        border-radius: 1.5rem;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        padding: 2rem;
        margin-bottom: 2rem;
    }
    
    .dark-theme .meeting-container {
        background: #2a2a2a;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }
    
    .form-label {
        font-weight: 600;
        color: var(--accent-color-dark);
        margin-bottom: 0.5rem;
    }
    
    .dark-theme .form-label {
        color: var(--accent-color-light);
    }
    
    .form-control {
        border-radius: 0.75rem;
        padding: 0.75rem 1rem;
        border: 1px solid rgba(0, 0, 0, 0.1);
        background: rgba(255, 255, 255, 0.9);
        transition: all 0.3s ease;
    }
    
    .dark-theme .form-control {
        background: rgba(60, 60, 60, 0.9);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: white;
    }
    
    .form-control:focus {
        box-shadow: 0 0 0 3px rgba(190, 155, 123, 0.3);
        border-color: var(--accent-color);
    }
    
    .dark-theme .form-control:focus {
        box-shadow: 0 0 0 3px rgba(190, 155, 123, 0.3);
        border-color: var(--accent-color-dark);
    }
    
    .btn-primary {
        background: linear-gradient(135deg, var(--accent-color) 0%, var(--accent-color-dark) 100%);
        border: none;
        border-radius: 2rem;
        padding: 0.75rem 1.5rem;
        font-weight: 600;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }
    
    .dark-theme .btn-primary {
        background: linear-gradient(135deg, var(--accent-color-dark) 0%, #614931 100%);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }
    
    .btn-primary:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    }
    
    .user-card {
        background: rgba(255, 255, 255, 0.7);
        border-radius: 1rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }
    
    .dark-theme .user-card {
        background: rgba(60, 60, 60, 0.7);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .user-avatar {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        margin-right: 1rem;
    }
    
    .item-thumbnail {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 1rem;
        margin-right: 1rem;
    }
    
    .item-preview {
        display: flex;
        align-items: center;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 1rem;
        padding: 1rem;
        margin-bottom: 1.5rem;
    }
    
    .dark-theme .item-preview {
        background: rgba(60, 60, 60, 0.5);
    }
    
    .tips-container {
        background: rgba(255, 255, 255, 0.7);
        border-radius: 1rem;
        padding: 1.5rem;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
    }
    
    .dark-theme .tips-container {
        background: rgba(60, 60, 60, 0.7);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }
    
    .tips-list li {
        margin-bottom: 0.75rem;
    }
    
    .meeting-option {
        background: rgba(255, 255, 255, 0.7);
        border-radius: 1rem;
        padding: 1.25rem;
        margin-bottom: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
    }
    
    .meeting-option:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }
    
    .meeting-option.selected {
        border-color: var(--accent-color);
        background: rgba(190, 155, 123, 0.1);
    }
    
    .dark-theme .meeting-option {
        background: rgba(60, 60, 60, 0.7);
    }
    
    .dark-theme .meeting-option.selected {
        border-color: var(--accent-color-dark);
        background: rgba(190, 155, 123, 0.2);
    }
</style>
{% endblock %}

{% block content %}
<section class="meeting-header">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <h1 class="text-white mb-1">Schedule Virtual Meeting</h1>
                <p class="lead text-white mb-0">Coordinate item delivery with {{ other_user.username }}</p>
            </div>
        </div>
    </div>
</section>

<div class="container">
    <div class="row">
        <div class="col-md-8">
            <div class="meeting-container">
                <!-- Item Preview -->
                <div class="item-preview">
                    <img src="{{ url_for('static', filename=item.image) }}" class="item-thumbnail" alt="{{ item.name }}">
                    <div>
                        <h5 class="mb-1">{{ item.name }}</h5>
                        <p class="mb-0 text-muted">{{ item.category }} â€¢ {{ item.condition }}</p>
                    </div>
                </div>
                
                <!-- Meeting Form -->
                <form method="POST" action="{{ url_for('schedule_swap_meeting', item_id=item.id) }}">
                    <div class="mb-4">
                        <h4>Choose a Meeting Platform</h4>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="meeting-option" data-platform="zoom">
                                    <div class="text-center">
                                        <i class="fas fa-video fa-2x mb-2" style="color: #2D8CFF;"></i>
                                        <h5>Zoom</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="meeting-option" data-platform="meet">
                                    <div class="text-center">
                                        <i class="fas fa-video fa-2x mb-2" style="color: #00897B;"></i>
                                        <h5>Google Meet</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="meeting-option" data-platform="teams">
                                    <div class="text-center">
                                        <i class="fas fa-video fa-2x mb-2" style="color: #6264A7;"></i>
                                        <h5>Microsoft Teams</h5>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="meeting_time" class="form-label">Meeting Date & Time</label>
                        <input type="datetime-local" class="form-control" id="meeting_time" name="meeting_time" required>
                        <div class="form-text">Choose a time that works for both you and {{ other_user.username }}.</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="meeting_link" class="form-label">Meeting Link</label>
                        <input type="url" class="form-control" id="meeting_link" name="meeting_link" placeholder="https://..." required>
                        <div class="form-text">Paste the link to your virtual meeting room</div>
                    </div>
                    
                    <div class="mb-3 form-check">
                        <input type="checkbox" class="form-check-input" id="confirmCheck" required>
                        <label class="form-check-label" for="confirmCheck">I confirm that I will attend this meeting to coordinate the item delivery</label>
                    </div>
                    
                    <div class="text-center mt-4">
                        <a href="{{ url_for('swap_item_details', item_id=item.id) }}" class="btn btn-secondary me-2">Cancel</a>
                        <button type="submit" class="btn btn-primary">Schedule Meeting</button>
                    </div>
                </form>
            </div>
        </div>
        
        <div class="col-md-4">
            <!-- Other User Info -->
            <div class="meeting-container">
                <h4>Meeting with</h4>
                <div class="user-card d-flex align-items-center">
                    <img src="https://via.placeholder.com/60" class="user-avatar" alt="User Avatar">
                    <div>
                        <h5 class="mb-0">{{ other_user.username }}</h5>
                        <p class="text-muted mb-0">{{ 'Owner' if other_user.id == item.user_id else 'Recipient' }}</p>
                    </div>
                </div>
            </div>
            
            <!-- Meeting Tips -->
            <div class="meeting-container">
                <h4>Virtual Meeting Tips</h4>
                <div class="tips-container">
                    <ul class="tips-list">
                        <li>Confirm the meeting time with {{ other_user.username }} through chat before scheduling</li>
                        <li>Create the meeting on your preferred platform and share the link</li>
                        <li>During the meeting, discuss how the physical item will be delivered</li>
                        <li>Take a photo of the item before sending it for verification</li>
                        <li>After the meeting, return here to confirm the delivery arrangement</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Handle meeting platform selection
        const meetingOptions = document.querySelectorAll('.meeting-option');
        let selectedPlatform = '';
        
        meetingOptions.forEach(option => {
            option.addEventListener('click', function() {
                // Remove selected class from all options
                meetingOptions.forEach(opt => opt.classList.remove('selected'));
                
                // Add selected class to clicked option
                this.classList.add('selected');
                
                // Get selected platform
                selectedPlatform = this.getAttribute('data-platform');
                
                // Add hint text based on platform
                const meetingLinkInput = document.getElementById('meeting_link');
                
                if (selectedPlatform === 'zoom') {
                    meetingLinkInput.placeholder = 'https://zoom.us/j/...';
                } else if (selectedPlatform === 'meet') {
                    meetingLinkInput.placeholder = 'https://meet.google.com/...';
                } else if (selectedPlatform === 'teams') {
                    meetingLinkInput.placeholder = 'https://teams.microsoft.com/l/meetup-join/...';
                }
            });
        });
        
        // Set default datetime to tomorrow at noon
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        tomorrow.setHours(12, 0, 0, 0);
        
        const meetingTimeInput = document.getElementById('meeting_time');
        meetingTimeInput.value = tomorrow.toISOString().slice(0, 16);
    });
</script>
{% endblock %} 